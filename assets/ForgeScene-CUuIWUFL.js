import{i as S,C as v,S as G,T as j,g as C,O as yt,h as gt,R as K,N as st,P as Q,f as b}from"./index-BBAcTXf4.js";import{T as St,G as Ct,a as X}from"./GameScene-S2qBzv7f.js";var J={},T={},nt;function N(){if(nt)return T;nt=1,Object.defineProperty(T,"__esModule",{value:!0}),T.Collector=void 0;let s=class{constructor(i){this.emit=(...e)=>{i.emitCollecting(this,e)}}};return T.Collector=s,T}var A={},ht;function Vt(){if(ht)return A;ht=1,Object.defineProperty(A,"__esModule",{value:!0}),A.CollectorArray=void 0;const s=N();let t=class extends s.Collector{constructor(){super(...arguments),this.result=[]}handleResult(e){return this.result.push(e),!0}getResult(){return this.result}reset(){this.result.length=0}};return A.CollectorArray=t,A}var O={},rt;function Pt(){if(rt)return O;rt=1,Object.defineProperty(O,"__esModule",{value:!0}),O.CollectorLast=void 0;const s=N();let t=class extends s.Collector{handleResult(e){return this.result=e,!0}getResult(){return this.result}reset(){delete this.result}};return O.CollectorLast=t,O}var M={},ot;function It(){if(ot)return M;ot=1,Object.defineProperty(M,"__esModule",{value:!0}),M.CollectorUntil0=void 0;const s=N();let t=class extends s.Collector{constructor(){super(...arguments),this.result=!1}handleResult(e){return this.result=e,this.result}getResult(){return this.result}reset(){this.result=!1}};return M.CollectorUntil0=t,M}var D={},at;function kt(){if(at)return D;at=1,Object.defineProperty(D,"__esModule",{value:!0}),D.CollectorWhile0=void 0;const s=N();let t=class extends s.Collector{constructor(){super(...arguments),this.result=!1}handleResult(e){return this.result=e,!this.result}getResult(){return this.result}reset(){this.result=!1}};return D.CollectorWhile0=t,D}var B={},E={},lt;function Tt(){if(lt)return E;lt=1,Object.defineProperty(E,"__esModule",{value:!0}),E.SignalConnectionImpl=void 0;class s{constructor(i,e){this.link=i,this.parentCleanup=e}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(i){this.link&&this.link.setEnabled(i)}get enabled(){return this.link!==null&&this.link.isEnabled()}}return E.SignalConnectionImpl=s,E}var R={},dt;function At(){if(dt)return R;dt=1,Object.defineProperty(R,"__esModule",{value:!0}),R.SignalLink=void 0;let s=class wt{constructor(i=null,e=null,n=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=i??this,this.next=e??this,this.order=n}isEnabled(){return this.enabled&&!this.newLink}setEnabled(i){this.enabled=i}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(i,e){let n=this.prev;for(;n!==this&&!(n.order<=e);)n=n.prev;const h=new wt(n,n.next,e);return h.callback=i,n.next=h,h.next.prev=h,h}};return R.SignalLink=s,R}var ct;function Ot(){if(ct)return B;ct=1,Object.defineProperty(B,"__esModule",{value:!0}),B.Signal=void 0;const s=Tt(),t=At();let i=class{constructor(){this.head=new t.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(n,h=0){this.connectionsCount++;const r=this.head.insert(n,h);return this.emitDepth>0&&(this.hasNewLinks=!0,r.newLink=!0),new s.SignalConnectionImpl(r,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(n){for(let h=this.head.next;h!==this.head;h=h.next)if(h.callback===n)return this.decrementConnectionCount(),h.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...n){this.emitDepth++;for(let h=this.head.next;h!==this.head;h=h.next)h.isEnabled()&&h.callback&&h.callback.apply(null,n);this.emitDepth--,this.unsetNewLink()}emitCollecting(n,h){this.emitDepth++;for(let r=this.head.next;r!==this.head;r=r.next)if(r.isEnabled()&&r.callback){const o=r.callback.apply(null,h);if(!n.handleResult(o))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let n=this.head.next;n!==this.head;n=n.next)n.newLink=!1;this.hasNewLinks=!1}}};return B.Signal=i,B}var F={},ut;function Mt(){if(ut)return F;ut=1,Object.defineProperty(F,"__esModule",{value:!0}),F.SignalConnections=void 0;let s=class{constructor(){this.list=[]}add(i){this.list.push(i)}disconnectAll(){for(const i of this.list)i.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}};return F.SignalConnections=s,F}var pt;function Dt(){return pt||(pt=1,(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.SignalConnections=s.Signal=s.CollectorWhile0=s.CollectorUntil0=s.CollectorLast=s.CollectorArray=s.Collector=void 0;var t=N();Object.defineProperty(s,"Collector",{enumerable:!0,get:function(){return t.Collector}});var i=Vt();Object.defineProperty(s,"CollectorArray",{enumerable:!0,get:function(){return i.CollectorArray}});var e=Pt();Object.defineProperty(s,"CollectorLast",{enumerable:!0,get:function(){return e.CollectorLast}});var n=It();Object.defineProperty(s,"CollectorUntil0",{enumerable:!0,get:function(){return n.CollectorUntil0}});var h=kt();Object.defineProperty(s,"CollectorWhile0",{enumerable:!0,get:function(){return h.CollectorWhile0}});var r=Ot();Object.defineProperty(s,"Signal",{enumerable:!0,get:function(){return r.Signal}});var o=Mt();Object.defineProperty(s,"SignalConnections",{enumerable:!0,get:function(){return o.SignalConnections}})})(J)),J}var g=Dt(),Bt=Object.defineProperty,Et=(s,t,i)=>t in s?Bt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,w=(s,t,i)=>Et(s,typeof t!="symbol"?t+"":t,i);class Rt{constructor(){w(this,"_isMouseIn",!1),w(this,"_isDown",!1),w(this,"onDown"),w(this,"onUp"),w(this,"onUpOut"),w(this,"onOut"),w(this,"onPress"),w(this,"onHover"),this.onPress=new g.Signal,this.onDown=new g.Signal,this.onUp=new g.Signal,this.onHover=new g.Signal,this.onOut=new g.Signal,this.onUpOut=new g.Signal}connectEvents(t){S.any?(t.on("pointerdown",this.processDown,this),t.on("pointerup",this.processUp,this),t.on("pointerupoutside",this.processUpOut,this),t.on("pointerout",this.processOut,this),t.on("pointertap",this.processPress,this),t.on("pointerover",this.processOver,this)):(t.on("mousedown",this.processDown,this),t.on("mouseup",this.processUp,this),t.on("mouseupoutside",this.processUpOut,this),t.on("mouseout",this.processOut,this),t.on("click",this.processPress,this),t.on("mouseover",this.processOver,this))}disconnectEvents(t){S.any?(t.off("pointerdown",this.processDown,this),t.off("pointerup",this.processUp,this),t.off("pointerupoutside",this.processUpOut,this),t.off("pointerout",this.processOut,this),t.off("pointertap",this.processPress,this),t.off("pointerover",this.processOver,this)):(t.off("mousedown",this.processDown,this),t.off("mouseup",this.processUp,this),t.off("mouseupoutside",this.processUpOut,this),t.off("mouseout",this.processOut,this),t.off("click",this.processPress,this),t.off("mouseover",this.processOver,this))}processDown(t){this._isDown=!0,this.onDown.emit(this,t),this.down(t)}processUp(t){this._isDown&&(this.onUp.emit(this,t),this.up(t)),this._isDown=!1}processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t),this.up(t),this.upOut(t)),this._isDown=!1}processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t),this.out(t))}processPress(t){this._isDown=!1,this.onPress.emit(this,t),this.press(t)}processOver(t){S.any||(this._isMouseIn=!0,this.onHover.emit(this,t),this.hover(t))}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}get isDown(){return this._isDown}}var Ft=Object.defineProperty,Ut=(s,t,i)=>t in s?Ft(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,x=(s,t,i)=>Ut(s,typeof t!="symbol"?t+"":t,i);class Ht extends Rt{constructor(t){super(),x(this,"_view"),t&&(this.view=t,this.enabled=!0)}set view(t){this._view&&this._view&&this.disconnectEvents(this._view),this._view=t,this.connectEvents(this._view)}get view(){return this._view}set enabled(t){if(!this.view){console.error("Button view is not set. Please set it before enabling the button.");return}this.view.eventMode=t?"static":"auto",this.view.cursor=t?"pointer":"default",!t&&this.isDown&&this.processUp()}get enabled(){return this.view?.eventMode==="static"}}class Nt extends v{constructor(t){super(),x(this,"button"),x(this,"onDown"),x(this,"onUp"),x(this,"onUpOut"),x(this,"onOut"),x(this,"onPress"),x(this,"onHover"),this.button=new Ht(this),this.button.enabled=!0,t&&this.addChild(t),this.onPress=this.button.onPress,this.onDown=this.button.onDown,this.onUp=this.button.onUp,this.onHover=this.button.onHover,this.onOut=this.button.onOut,this.onUpOut=this.button.onUpOut}set enabled(t){this.button.enabled=t}get enabled(){return this.button.enabled}}function z(s){return typeof s=="string"?G.from(s):s instanceof j?new G(s):s}let H;typeof self>"u"&&typeof process<"u"&&process.hrtime?H=function(){const s=process.hrtime();return s[0]*1e3+s[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?H=self.performance.now.bind(self.performance):Date.now!==void 0?H=Date.now:H=function(){return new Date().getTime()};class _{constructor(){_.prototype.__init.call(this),_.prototype.__init2.call(this),_.prototype.__init3.call(this),_.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return _._shared||(_._shared=new _),_._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=H}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,i=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const e=Object.keys(this._tweens);if(e.length==0)return!1;for(let n=0;n<e.length;n++){const h=this._tweens[e[n]];h&&h.update(t,!0)==!1&&!i&&delete this._tweens[e[n]]}return!0}}const Lt={Linear:{None(s){return s}}},mt={Geom:{Linear(s,t){const i=s.length-1,e=i*t,n=Math.floor(e),h=mt.Utils.Linear;return t<0?h(s[0],s[1],e):t>1?h(s[i],s[i-1],i-e):h(s[n],s[n+1>i?i:n+1],e-n)}},Utils:{Linear(s,t,i){return(t-s)*i+s}}};class ${static __initStatic(){this._nextId=0}static nextId(){return $._nextId++}}$.__initStatic();const L={safetyCheckFunction:s=>!0,easingFunction:Lt.Linear.None,yoyoEasingFunction:void 0,interpolationFunction:mt.Geom.Linear};class c{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=L.safetyCheckFunction}__init15(){this._easingFunction=L.easingFunction}__init16(){this._yoyoEasingFunction=L.yoyoEasingFunction}__init17(){this._interpolationFunction=L.interpolationFunction}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=$.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:_.shared}set _group(t){this._groupRef=t}constructor(t,i){c.prototype.__init.call(this),c.prototype.__init2.call(this),c.prototype.__init3.call(this),c.prototype.__init4.call(this),c.prototype.__init5.call(this),c.prototype.__init6.call(this),c.prototype.__init7.call(this),c.prototype.__init8.call(this),c.prototype.__init9.call(this),c.prototype.__init10.call(this),c.prototype.__init11.call(this),c.prototype.__init12.call(this),c.prototype.__init13.call(this),c.prototype.__init14.call(this),c.prototype.__init15.call(this),c.prototype.__init16.call(this),c.prototype.__init17.call(this),c.prototype.__init18.call(this),c.prototype.__init19.call(this),c.prototype.__init20.call(this),c.prototype.__init21.call(this),c.prototype.__init22.call(this),this._object=t,this._group=i}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,i){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,i)}return i!==void 0&&(this._duration=i),this}dynamicTo(t,i){return this._valuesEnd=t,i!==void 0&&(this._duration=i),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,i,e,n,h){for(const r in e){const o=t[r],a=Array.isArray(o),d=!Number.isNaN(Number(o)),u=a?"array":typeof o,V=u=="object",k=typeof e[r]=="object",P=!a&&Array.isArray(e[r]);u=="undefined"||u=="function"||e[r]==null||!a&&!d&&!V||((V||a||k)&&o&&!P?(typeof i[r]>"u"&&(i[r]=a?[]:{}),typeof n[r]>"u"&&(n[r]=a?[]:{}),this._setupProperties(o,i[r],e[r],n[r],h)):((typeof i[r]>"u"||h)&&(i[r]=o),(typeof n[r]>"u"||h)&&(P?n[r]=e[r].slice().reverse()[0]:n[r]=i[r]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let i=[];if(t||(i=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=i;for(let e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].start()}return this}skip(t,i=!1){return this.resume(),this.update(t*this._duration-(i?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,i=this._chainedTweens.length;t<i;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let i=0,e=this._chainedTweens.length;i<e;i++)this._chainedTweens[i].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,i=!1){const e=this._internalUpdate(t);return!e&&!i&&this._group.remove(this),e}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let i;this._elapsedTime+=t;const e=this._duration,n=this._startTime+this._elapsedTime;if(n>e&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&n>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),i=n/this._duration,this._duration==0&&(n>=0?i=1:i=0),i=Math.min(1,i),i=Math.max(0,i);let h=Number.isFinite(n)?n%this._duration:n;Number.isNaN(h)&&(h=0);const r=Math.floor(n/this._duration);let o;if(this._reversed&&this._yoyoEasingFunction?o=this._yoyoEasingFunction(i):o=this._easingFunction(i),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&(i!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,i,this),i==1){if(this._repeat-this._repeatCount>0){const a=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+r),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||h<=0)&&this._onUpdateCallback(this._object,i,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let d=1;Number.isFinite(r)?d=this._repeatCount-a:Number.isFinite(this._repeat)&&(d=this._repeat-a);for(let u=0;u<d;u++)this._onRepeatCallback(this._object,a+1+u,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return h>0&&Number.isFinite(this._repeat)&&this._internalUpdate(h),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let a=0,d=this._chainedTweens.length;a<d;a++)this._chainedTweens[a].start(),h>0&&this._chainedTweens[a].update(h);return this._isPlaying=!1,!1}return!0}_updateProperties(t,i,e,n){for(const h in e){if(i[h]==null)continue;const r=i[h];let o=e[h];const a=Array.isArray(t[h]),d=Array.isArray(o);!a&&d?this._reversed?t[h]=this._interpolationFunction(o.concat([r]),n):t[h]=this._interpolationFunction([r].concat(o),n):typeof o=="object"&&o?this._updateProperties(t[h],r,o,n):(o=this._handleRelativeValue(r,o),typeof o=="number"&&(typeof r=="number"||typeof r=="string")&&(t[h]=Number(r)+(o-Number(r))*n,typeof r=="string"&&(t[h]=String(t[h]))))}}_handleRelativeValue(t,i){return typeof i!="string"?i:i.charAt(0)=="+"||i.charAt(0)=="-"?t+Number(i):Number(i)}_swapEndStartRepeatValues(t,i){for(const e in t){const n=!Array.isArray(t[e])&&Array.isArray(i[e]);if(typeof t[e]=="object")this._swapEndStartRepeatValues(t[e],i[e]);else{const h=t[e];if(typeof i[e]=="string")t[e]=Number(t[e])+Number(i[e]),i[e]=h;else if(n){const r=i[e].slice().reverse();t[e]=r[0],i[e]=r}else t[e]=i[e],i[e]=h}}}_moveForwardStartRepeatValues(t,i){for(const e in t)typeof i[e]=="object"?this._moveForwardStartRepeatValues(t[e],i[e]):typeof i[e]=="string"&&(t[e]=Number(t[e])+Number(i[e]))}}function ft(s,t,i=0,e=!0){let n=t.scale.x,h=t.scale.y;if(!s)throw new Error("Parent is not defined");const r=s.width-i*2,o=s.height-i*2,a=r-Math.round(t.width),d=o-Math.round(t.height);if(a<0&&(n=r/(t.width/n)),d<0&&(h=o/(t.height/h)),n<=0||h<=0){t.scale.set(0);return}if(e||t.scale.x===t.scale.y){const u=Math.min(n,h);t.scale.set(u,u)}else{const u=t.scale.x/t.scale.y;a<d?t.scale.set(n,n/u):t.scale.set(h*u,h)}}function Wt(s){return typeof s=="string"||typeof s=="number"?new C({text:String(s)}):s}var jt=Object.defineProperty,zt=(s,t,i)=>t in s?jt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,p=(s,t,i)=>zt(s,typeof t!="symbol"?t+"":t,i);class Z extends Nt{constructor(t){super(),p(this,"animations"),p(this,"originalInnerViewState"),p(this,"defaultDuration",100),p(this,"options"),p(this,"_padding",0),p(this,"_offset",{}),p(this,"_textOffset",{}),p(this,"iconOffset",{}),p(this,"innerView",new v),p(this,"_views",{}),p(this,"state","default"),p(this,"anchor"),p(this,"_defaultTextScale",{x:1,y:1}),p(this,"_defaultIconScale",{x:1,y:1}),p(this,"_defaultTextAnchor",{x:.5,y:.5}),p(this,"_defaultIconAnchor",{x:.5,y:.5}),this.options=t??{};const{defaultView:i,hoverView:e,pressedView:n,disabledView:h,text:r,padding:o,offset:a,textOffset:d,iconOffset:u,defaultTextScale:V,defaultIconScale:k,defaultTextAnchor:P,defaultIconAnchor:Y,scale:q,anchor:tt,anchorX:bt,anchorY:vt,icon:it,animations:et}=t??{};this.addChild(this.innerView),this.anchor=new yt({_onUpdate:()=>this.updateAnchor()}),this.anchor.set(bt??tt??0,vt??tt??0),this.padding=o??0,this.offset=a??{},this.textOffset=d??{},this.iconOffset=u??{},this.defaultTextScale=V??{x:1,y:1},this.defaultIconScale=k??{x:1,y:1},this.defaultTextAnchor=P??{x:.5,y:.5},this.defaultIconAnchor=Y??{x:.5,y:.5},this.scale.set(q??1),et&&(this.animations=et,this.setOriginalInnerViewState(),gt.shared.add(()=>_.shared.update())),this.setState("default"),this.defaultView=i,this.hoverView=e,this.pressedView=n,this.disabledView=h,this.text=r??"",it!==void 0&&(this.iconView=it),this.initStateControl()}set text(t){if(!t||t===0){this.removeView("textView");return}if(!this._views.textView){this.createTextView(t);return}this._views.textView.text=t.toString()}get text(){return this._views.textView?.text}set enabled(t){this.button.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.button.enabled}setState(t,i=!1){if(!i&&this.state===t)return;const e=this.getStateView(this.state);e&&(e.visible=!1),this.state=t;const n=this.getStateView(t);n&&(this.setOffset(n,t,this.offset),n.visible=!0),this.updateAnchor(),this.playAnimations(t)}createTextView(t){if(this._views.textView=Wt(t),this.options?.defaultTextScale===void 0){const{x:i,y:e}=this._views.textView.scale;this._defaultTextScale={x:i,y:e}}this.innerView.addChild(this._views.textView),this.adjustTextView(this.state)}setOffset(t,i,e){const n=e?e[i]:{x:0,y:0},h=e?.default;n?(t.x+=n.x??0,t.y+=n.y??0):h?(t.x+=h.x??0,t.y+=h.y??0):(e.x||e.y)&&(t.x+=e.x??0,t.y+=e.y??0)}getStateView(t){if(this._views)switch(t){case"hover":return this._views.hoverView??this._views.defaultView??void 0;case"pressed":return this._views.pressedView??this._views.hoverView??this._views.defaultView??void 0;case"disabled":return this._views.disabledView??this._views.defaultView??void 0;case"default":return this._views.defaultView??void 0;default:return}}adjustTextView(t){if(!this.text||!this._views.textView)return;const i=this.getStateView(this.state),e=this._defaultTextAnchor.x??.5,n=this._defaultTextAnchor.y??.5;if(i){if(this.options?.ignoreRefitting||this._views.textView.scale.set(this._defaultTextScale.x,this._defaultTextScale.y),this.contentFittingMode==="default"&&ft(i,this._views.textView,this.padding,!1),this.contentFittingMode==="fill"){this._views.textView.scale.set(1);const h=i.width-this.padding*2,r=i.height-this.padding*2,o=h/this._views.textView.width,a=r/this._views.textView.height,d=Math.min(o,a);this._views.textView.scale.set(d*(this._defaultTextScale.x??1),d*(this._defaultTextScale.y??1))}this._views.textView.x=i.x+i.width/2,this._views.textView.y=i.y+i.height/2}this._views.textView.anchor.set(e,n),this.setOffset(this._views.textView,t,this.textOffset)}adjustIconView(t){if(!this._views.iconView)return;const i=this.getStateView(t);if(!i)return;if(this.options?.ignoreRefitting||this._views.iconView.scale.set(this._defaultIconScale.x,this._defaultIconScale.y),this.contentFittingMode==="default"&&ft(i,this._views.iconView,this.padding,!1),this.contentFittingMode==="fill"){this._views.iconView.scale.set(1);const h=i.width-this.padding*2,r=i.height-this.padding*2,o=h/this._views.iconView.width,a=r/this._views.iconView.height,d=Math.min(o,a);this._views.iconView.scale.set(d*(this._defaultIconScale.x??1),d*(this._defaultIconScale.y??1))}const e=this._defaultIconAnchor.x??.5,n=this._defaultIconAnchor.y??.5;"anchor"in this._views.iconView?this._views.iconView.anchor.set(e,n):this._views.iconView.pivot.set(e*(this._views.iconView.width/this._views.iconView.scale.x),n*(this._views.iconView.height/this._views.iconView.scale.y)),this._views.iconView.x=i.x+i.width/2,this._views.iconView.y=i.y+i.height/2,this.setOffset(this._views.iconView,t,this.iconOffset)}updateAnchor(){if(!this._views)return;const t=this.anchor.x??0,i=this.anchor.y??0;if([this._views.defaultView,this._views.hoverView,this._views.pressedView,this._views.disabledView].forEach(n=>{n&&(n.anchor?.set(0),n.x=-n.width*t,n.y=-n.height*i)}),this._views.defaultView){const{x:n,y:h,width:r,height:o}=this._views.defaultView;this.hitArea=new K(n,h,r,o)}this.adjustIconView(this.state),this.adjustTextView(this.state)}set contentFittingMode(t){this.options.contentFittingMode=t}get contentFittingMode(){return this.options.contentFittingMode??"default"}set defaultView(t){this.updateView("defaultView",t),this._views.disabledView&&this.state!=="default"&&(this._views.disabledView.visible=!1)}get defaultView(){return this._views.defaultView}set hoverView(t){this.updateView("hoverView",t),this._views.hoverView&&this.state!=="hover"&&(this._views.hoverView.visible=!1)}get hoverView(){return this._views.hoverView}set pressedView(t){this.updateView("pressedView",t),this._views.pressedView&&this.state!=="pressed"&&(this._views.pressedView.visible=!1)}get pressedView(){return this._views.pressedView}set disabledView(t){this.updateView("disabledView",t),this._views.disabledView&&this.state!=="disabled"&&(this._views.disabledView.visible=!1)}get disabledView(){return this._views.disabledView}updateView(t,i){i!==void 0&&(this.removeView(t),this.options?.nineSliceSprite&&(typeof i=="string"?this._views[t]=new st({texture:j.from(i),leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):i instanceof j?this._views[t]=new st({texture:i,leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):console.warn("NineSliceSprite can not be used with views set as Container. Pass the texture or texture name as instead of the Container extended instance.")),this._views[t]||(this._views[t]=z(i)),this.setOffset(this._views[t],this.state,this.offset),this._views[t].parent||this.innerView.addChild(this._views[t]),this.updateAnchor(),this._views.iconView&&this.innerView.addChild(this._views.iconView),this._views.textView&&this.innerView.addChild(this._views.textView),this.setState(this.state,!0))}removeView(t){this._views[t]&&(this.innerView.removeChild(this._views[t]),this._views[t]=void 0)}set textView(t){t!==void 0&&(this.removeView("textView"),t!==null&&this.createTextView(t))}get textView(){return this._views.textView}set iconView(t){if(t!==void 0&&(this.removeView("iconView"),t!==null)){if(this._views.iconView=z(t),this.options?.defaultIconScale===void 0){const{x:i,y:e}=this._views.iconView.scale;this._defaultIconScale={x:i,y:e}}this._views.iconView.parent||this.innerView.addChild(this._views.iconView),this.setState(this.state,!0)}}get iconView(){return this._views.iconView}playAnimations(t){if(!this.animations)return;const i=this.animations[t]??this.animations.default;if(i){const e=i;this.defaultDuration=e.duration??this.defaultDuration,new c(this.innerView).to(e.props,e.duration).start();return}new c(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}setOriginalInnerViewState(){this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}};const t=this.animations?.default;t&&(this.innerView.x=t.props.x??this.originalInnerViewState.x??0,this.innerView.y=t.props.y??this.originalInnerViewState.y??0,this.innerView.width=t.props.width??this.originalInnerViewState.width??0,this.innerView.height=t.props.height??this.originalInnerViewState.height??0,this.innerView.scale.x=t.props.scale?.x??this.originalInnerViewState.scale?.x??1,this.innerView.scale.y=t.props.scale?.y??this.originalInnerViewState.scale?.y??1)}initStateControl(){this.onDown.connect(()=>{this.setState("pressed")}),this.onUp.connect(()=>{this.setState(S.any?"default":"hover")}),this.onUpOut.connect(()=>{this.setState("default")}),this.onOut.connect(()=>{this.button.isDown||this.setState("default")}),this.onPress.connect(()=>{this.setState(S.any?"default":"hover")}),this.onHover.connect(()=>{this.button.isDown||this.setState(S.any?"default":"hover")})}set padding(t){this._padding=t,this.adjustTextView(this.state),this.adjustIconView(this.state)}get padding(){return this._padding}set offset(t){this._offset=t,this.updateAnchor()}get offset(){return this._offset}set textOffset(t){this._textOffset=t,this.adjustTextView(this.state)}get textOffset(){return this._textOffset}set defaultTextScale(t){if(t===void 0)return;this.options.defaultTextScale=t;const i=typeof t=="number";this._defaultTextScale.x=i?t:t.x??1,this._defaultTextScale.y=i?t:t.y??1,this.adjustTextView(this.state)}get defaultTextScale(){return this.defaultTextScale}set defaultIconScale(t){if(t===void 0)return;this.options.defaultIconScale=t;const i=typeof t=="number";this._defaultIconScale.x=i?t:t.x??1,this._defaultIconScale.y=i?t:t.y??1,this.adjustIconView(this.state)}get defaultIconScale(){return this.defaultIconScale}set defaultTextAnchor(t){if(t===void 0)return;this.options.defaultTextAnchor=t;const i=typeof t=="number";this._defaultTextAnchor.x=i?t:t.x??1,this._defaultTextAnchor.y=i?t:t.y??1,this.adjustTextView(this.state)}get defaultTextAnchor(){return this.defaultTextAnchor}set defaultIconAnchor(t){if(t===void 0)return;this.options.defaultIconAnchor=t;const i=typeof t=="number";this._defaultIconAnchor.x=i?t:t.x??1,this._defaultIconAnchor.y=i?t:t.y??1,this.adjustIconView(this.state)}get defaultIconAnchor(){return this.defaultIconAnchor}set width(t){this.options?.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.width=t),this._views.hoverView&&(this._views.hoverView.width=t),this._views.pressedView&&(this._views.pressedView.width=t),this._views.disabledView&&(this._views.disabledView.width=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.width=t}get width(){return super.width}set height(t){this.options?.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.height=t),this._views.hoverView&&(this._views.hoverView.height=t),this._views.pressedView&&(this._views.pressedView.height=t),this._views.disabledView&&(this._views.disabledView.height=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.height=t}get height(){return super.height}setSize(t,i){this.options?.nineSliceSprite?(this._views.defaultView&&this._views.defaultView.setSize(t,i),this._views.hoverView&&this._views.hoverView.setSize(t,i),this._views.pressedView&&this._views.pressedView.setSize(t,i),this._views.disabledView&&this._views.disabledView.setSize(t,i),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.setSize(t,i)}}var $t=Object.defineProperty,Yt=(s,t,i)=>t in s?$t(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,W=(s,t,i)=>Yt(s,typeof t!="symbol"?t+"":t,i);class qt extends v{constructor(t){super(),W(this,"options"),W(this,"_type","bidirectional"),W(this,"_maxWidth",0),W(this,"children",[]),t&&(t.maxWidth&&(this._maxWidth=t.maxWidth),this.init(t)),t?.items?.forEach(i=>this.addChild(i)),this.on("added",()=>this.arrangeChildren()),this.on("childAdded",()=>this.arrangeChildren())}init(t){this.options=t,t?.type&&(this.type=t.type),t?.children&&t.children.forEach(i=>this.addChild(i))}set type(t){this._type=t,this.arrangeChildren()}get type(){return this._type}set elementsMargin(t){if(!this.options)throw new Error("List has not been initiated!");this.options.elementsMargin=t,this.arrangeChildren()}get elementsMargin(){return this.options?.elementsMargin??0}set padding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.padding=t,this.options.vertPadding=t,this.options.horPadding=t,this.options.leftPadding=t,this.options.rightPadding=t,this.options.topPadding=t,this.options.bottomPadding=t,this.arrangeChildren()}get padding(){return this.options?.padding??0}set vertPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.vertPadding=t,this.options.topPadding=t,this.options.bottomPadding=t,this.arrangeChildren()}get vertPadding(){return this.options?.vertPadding??this.padding??0}set horPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.horPadding=t,this.options.leftPadding=t,this.options.rightPadding=t,this.arrangeChildren()}get horPadding(){return this.options?.horPadding??this.padding??0}set leftPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.leftPadding=t,this.arrangeChildren()}get leftPadding(){return this.options?.leftPadding??this.horPadding}set rightPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.rightPadding=t,this.arrangeChildren()}get rightPadding(){return this.options?.rightPadding??this.horPadding}set topPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.topPadding=t,this.arrangeChildren()}get topPadding(){return this.options?.topPadding??this.vertPadding}set bottomPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.bottomPadding=t,this.arrangeChildren()}get bottomPadding(){return this.options?.bottomPadding??this.vertPadding}arrangeChildren(){let t=0,i=this.leftPadding,e=this.topPadding;const n=this.options?.elementsMargin??0;let h=this.maxWidth||this.parent?.width;this.rightPadding&&(h-=this.rightPadding),this.children.forEach((r,o)=>{switch(this.type){case"vertical":r.y=e,r.x=i,e+=n+r.height;break;case"horizontal":r.x=i,r.y=e,i+=n+r.width;break;default:r.x=i,r.y=e,r.x+r.width>h&&o>0&&(e+=n+t,i=this.leftPadding,r.x=i,r.y=e,t=0),t=Math.max(t,r.height),i+=n+r.width;break}})}removeItem(t){const i=this.children[t];i&&(this.removeChild(i),this.arrangeChildren())}set maxWidth(t){this._maxWidth=t,this.arrangeChildren()}get maxWidth(){return this._maxWidth}}var Xt=Object.defineProperty,Jt=(s,t,i)=>t in s?Xt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,U=(s,t,i)=>Jt(s,typeof t!="symbol"?t+"":t,i);class Zt{constructor(t={}){U(this,"x"),U(this,"ax"),U(this,"dx"),U(this,"tx"),U(this,"_options"),this.x=0,this.ax=0,this.dx=0,this.tx=0,this._options={max:t.max??160,damp:t.damp??.8,springiness:t.springiness??.1}}update(){this.ax=(this.tx-this.x)*this._options.springiness,this.dx+=this.ax,this.dx*=this._options.damp,this.dx<-this._options.max?this.dx=-this._options.max:this.dx>this._options.max&&(this.dx=this._options.max),this.x+=this.dx}reset(){this.x=0,this.ax=0,this.dx=0,this.tx=0}get max(){return this._options.max}set max(t){this._options.max=t}get damp(){return this._options.damp}set damp(t){this._options.damp=t}get springiness(){return this._options.springiness}set springiness(t){this._options.springiness=t}}var Gt=Object.defineProperty,Kt=(s,t,i)=>t in s?Gt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,I=(s,t,i)=>Kt(s,typeof t!="symbol"?t+"":t,i);class Qt{constructor(){I(this,"done",!1),I(this,"to",0),I(this,"_spring"),I(this,"_pos",0),I(this,"_speed",0),I(this,"_correctSpeed",!1),this._spring=new Zt,this._pos=0,this.to=0}start(t,i,e){this._speed=t,this._pos=i,this.to=e,this.done=!1,this._spring.x=this._pos,this._spring.tx=this.to;const n=this.to-this._pos,h=Math.abs(n)/n,r=Math.abs(this._speed)/this._speed;h!==r?this._correctSpeed=!0:this._correctSpeed=!1}update(){if(this._correctSpeed)this._speed*=.6,Math.abs(this._speed)<2&&(this._correctSpeed=!1),this._pos+=this._speed,this._spring.x=this._pos;else{const t=this.to-this._pos;Math.abs(t)<.05?(this._pos=this.to,this.done=!0):(this._spring.tx=this.to,this._spring.update(),this._pos=this._spring.x)}return this._pos}cancel(){}}var ti=Object.defineProperty,ii=(s,t,i)=>t in s?ti(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,f=(s,t,i)=>ii(s,typeof t!="symbol"?t+"":t,i);class _t{constructor(t={}){f(this,"position",0),f(this,"constrain",!0),f(this,"min",0),f(this,"max",0),f(this,"maxSpeed",400),f(this,"_ease"),f(this,"_offset",0),f(this,"_prev",0),f(this,"_speed",0),f(this,"_hasStopped",!1),f(this,"_targetSpeed",0),f(this,"_speedChecker",0),f(this,"_grab",0),f(this,"_activeEase"),this.constrain=t.constrain??!0,this.maxSpeed=t.maxSpeed??400,this._ease=t.ease??new Qt}set value(t){this._speed=0,this.position=t}get value(){return this.position}grab(t){this._grab=t,this._offset=this.position-t,this._speedChecker=0,this._targetSpeed=this._speed=0,this._hasStopped=!1}hold(t){this._speedChecker++,this.position=t+this._offset,this._speedChecker>1&&(this._targetSpeed=this.position-this._prev),this._speed+=(this._targetSpeed-this._speed)/2,this._speed>this.maxSpeed?this._speed=this.maxSpeed:this._speed<-this.maxSpeed&&(this._speed=-this.maxSpeed),this._prev=this.position,this.constrain&&(this._activeEase=void 0,this.position>this.min?this.position-=(this.position-this.min)/1.5:this.position<this.max&&(this.position+=(this.max-this.position)/1.5))}slide(t=!1){this._hasStopped||(this.constrain?this._updateConstrain(t):this._updateDefault())}get moveAmount(){return-(this.position-this._offset-this._grab)}_updateDefault(){this._speed*=.9,this.position+=this._speed,(this._speed<0?this._speed*-1:this._speed)<.01&&(this._hasStopped=!0)}_updateConstrain(t=!1){const i=this.max;t?(this.value>0&&(this.value=0),this.value>0&&(this.value=0),this.value<this.max&&(this.value=this.max),this.value<this.max&&(this.value=this.max)):this.position>this.min||this.position<i||this._activeEase?(this._activeEase||(this._activeEase=this._ease,this.position>this.min?this._activeEase.start(this._speed,this.position,this.min):this._activeEase.start(this._speed,this.position,i)),this.position=this._activeEase.update(),this._activeEase.done&&(this.position=this._activeEase.to,this._speed=0,this._activeEase=void 0)):this._updateDefault()}}var ei=Object.defineProperty,si=(s,t,i)=>t in s?ei(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,m=(s,t,i)=>si(s,typeof t!="symbol"?t+"":t,i);class ni{constructor(t){m(this,"xAxis"),m(this,"yAxis"),m(this,"_isDown",!1),m(this,"_globalPosition"),m(this,"_frame"),m(this,"_bounds"),m(this,"_dirty",!1),m(this,"disableEasing",!1),this.xAxis=new _t({ease:t.xEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.yAxis=new _t({ease:t.yEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.disableEasing=t.disableEasing??!1,this._frame=new K,this._bounds=new K,this._globalPosition=new Q}pointerDown(t){this._globalPosition=t,this.xAxis.grab(t.x),this.yAxis.grab(t.y),this._isDown=!0}pointerUp(){this._isDown=!1}pointerMove(t){this._globalPosition=t}update(){this._dirty&&this._bounds&&this._frame&&(this._dirty=!1,this.xAxis.min=this._bounds.left,this.xAxis.min=this._bounds.right-this._frame.width,this.xAxis.min=this._bounds.top,this.xAxis.min=this._bounds.bottom-this._frame.height),this._isDown&&this._globalPosition?(this.xAxis.hold(this._globalPosition.x),this.yAxis.hold(this._globalPosition.y)):(this.xAxis.slide(this.disableEasing),this.yAxis.slide(this.disableEasing))}resize(t,i){this._frame&&(this._frame.x=0,this._frame.width=t,this._frame.y=0,this._frame.height=i,this._dirty=!0)}setBounds(t,i,e,n){this._bounds&&(this._bounds.x=t,this._bounds.width=i-t,this._bounds.y=e,this._bounds.height=n-e,this._dirty=!0)}get x(){return this.xAxis.value}get y(){return this.yAxis.value}}var hi=Object.defineProperty,ri=(s,t,i)=>t in s?hi(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,l=(s,t,i)=>ri(s,typeof t!="symbol"?t+"":t,i);class oi extends v{constructor(t){super(),l(this,"background"),l(this,"borderMask"),l(this,"lastWidth",0),l(this,"lastHeight",0),l(this,"_width",0),l(this,"_height",0),l(this,"_dimensionChanged",!1),l(this,"list"),l(this,"_trackpad"),l(this,"isDragging",0),l(this,"interactiveStorage",[]),l(this,"visibleItems",[]),l(this,"pressedChild"),l(this,"ticker",gt.shared),l(this,"options",{}),l(this,"stopRenderHiddenItemsTimeout"),l(this,"onMouseScrollBinding",this.onMouseScroll.bind(this)),l(this,"dragStarTouchPoint"),l(this,"isOver",!1),l(this,"proximityRange",0),l(this,"proximityStatusCache",[]),l(this,"lastScrollX"),l(this,"lastScrollY"),l(this,"proximityCheckFrameCounter",0),l(this,"onProximityChange",new g.Signal),l(this,"onScroll",new g.Signal),t&&this.init(t),this.ticker.add(this.update,this)}init(t){this.options=t,this.setBackground(t.background),this._width=t.width??this.background?.width??100,this._height=t.height??this.background?.height??100,this.proximityRange=t.proximityRange??0,this.list||(this.list=new qt,super.addChild(this.list)),this.list?.init({type:t.type,elementsMargin:t.elementsMargin,padding:t.padding,vertPadding:t.vertPadding,horPadding:t.horPadding,topPadding:t.topPadding,bottomPadding:t.bottomPadding,leftPadding:t.leftPadding,rightPadding:t.rightPadding,maxWidth:t.maxWidth||(t.type!=="horizontal"&&t.type!=="vertical"?this._width:0)}),t.items&&this.addItems(t.items),this.hasBounds&&(this.addMask(),this.makeScrollable()),this._trackpad&&(this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0),this.options.globalScroll=t.globalScroll??!0,this.options.shiftScroll=t.shiftScroll??!1,this.resize()}get hasBounds(){return!!this._width||!!this._height}addItems(t){t?.length&&t.forEach(i=>this.addItem(i))}removeItems(){this.proximityStatusCache.length=0,this.list?.removeChildren()}addItem(...t){if(t.length>1)t.forEach(i=>this.addItem(i));else{const i=t[0];(!i.width||!i.height)&&console.error("ScrollBox item should have size"),i.eventMode="static",this.list?.addChild(i),this.proximityStatusCache.push(!1),this.options.disableDynamicRendering||(i.renderable=this.isItemVisible(i))}return this.resize(),t[0]}removeItem(t){this.list?.removeItem(t),this.proximityStatusCache.splice(t,1),this.resize()}isItemVisible(t,i=0){let e=!1;const n=this.list;if(!n)return!1;if(this.isVertical||this.isBidirectional){const h=t.y+n.y;h+t.height>=-i&&h<=(this.options.height??this._height)+i&&(e=!0)}if(this.isHorizontal||this.isBidirectional){const h=t.x+n.x;h+t.width>=-i&&h<=(this.options.width??this._width)+i&&(e=!0)}return e}get items(){return this.list?.children??[]}setBackground(t){this.background&&this.removeChild(this.background),this.options.background=t,this.background=new b,this.addChildAt(this.background,0),this.resize()}addMask(){this.borderMask||(this.borderMask=new b,super.addChild(this.borderMask),this.mask=this.borderMask),this.resize()}makeScrollable(){this._trackpad||(this._trackpad=new ni({disableEasing:this.options.disableEasing})),this.on("pointerdown",t=>{this.renderAllItems(),this.isDragging=1,this.dragStarTouchPoint=this.worldTransform.applyInverse(t.global),this._trackpad&&this.dragStarTouchPoint&&this._trackpad.pointerDown(new Q(this.dragStarTouchPoint.x,this.dragStarTouchPoint.y));const i=this.list?.worldTransform.applyInverse(t.global);i&&this.visibleItems.forEach(e=>{e.x<i.x&&e.x+e.width>i.x&&e.y<i.y&&e.y+e.height>i.y&&(this.pressedChild=e)})}),this.on("pointerup",()=>{this.isDragging=0,this._trackpad?.pointerUp(),this.restoreItemsInteractivity(),this.pressedChild=void 0,this.stopRenderHiddenItems()}),this.on("pointerover",()=>{this.isOver=!0}),this.on("pointerout",()=>{this.isOver=!1}),this.on("pointerupoutside",()=>{this.isDragging=0,this._trackpad?.pointerUp(),this.restoreItemsInteractivity(),this.pressedChild=void 0,this.stopRenderHiddenItems()}),this.on("globalpointermove",t=>{if(!this.isDragging)return;const i=this.worldTransform.applyInverse(t.global);if(this.dragStarTouchPoint){const e=this.options.dragTrashHold??10;if(this.isHorizontal||this.isBidirectional){const n=i.x-this.dragStarTouchPoint.x;Math.abs(n)>e&&(this.isDragging=2)}if(this.isVertical||this.isBidirectional){const n=i.y-this.dragStarTouchPoint.y;Math.abs(n)>e&&(this.isDragging=2)}}this.dragStarTouchPoint&&this.isDragging!==2||(this._trackpad?.pointerMove(new Q(i.x,i.y)),this.pressedChild&&(this.revertClick(this.pressedChild),this.pressedChild=void 0),this.isBidirectional?this.onScroll?.emit({x:this.scrollX,y:this.scrollY}):this.onScroll?.emit(this.isVertical?this.scrollY:this.scrollX))}),document.addEventListener("wheel",this.onMouseScrollBinding,!0)}setInteractive(t){this.eventMode=t?"static":"auto"}get listHeight(){return(this.list?.height??0)+(this.list?.topPadding??0)+(this.list?.bottomPadding??0)}get listWidth(){return(this.list?.width??0)+(this.list?.leftPadding??0)+(this.list?.rightPadding??0)}resize(t=!1){if(this.hasBounds){if(this.renderAllItems(),this.borderMask&&(t||this._dimensionChanged||this.lastWidth!==this.listWidth||this.lastHeight!==this.listHeight)){this.options.width||(this._width+=this.listWidth),this.options.height||(this._height+=this.listHeight),this.borderMask?.clear().roundRect(0,0,this._width,this._height,(this.options.radius??0)|0).fill(16711935).stroke(0),this.borderMask&&(this.borderMask.eventMode="none");const i=this.options.background;this.background?.clear().roundRect(0,0,this._width,this._height,(this.options.radius??0)|0).fill({color:i??0,alpha:i?1:1e-7}),this.isBidirectional?this.setInteractive(this.listWidth>this._width||this.listHeight>this._height):this.isHorizontal?this.setInteractive(this.listWidth>this._width):this.setInteractive(this.listHeight>this._height),this.lastWidth=this.listWidth,this.lastHeight=this.listHeight}if(this._trackpad&&this.borderMask){const i=this.borderMask.width-(this.list?.width??0)-(this.list?.leftPadding??0)-(this.list?.rightPadding??0),e=this.borderMask.height-(this.list?.height??0)-(this.list?.topPadding??0)-(this.list?.bottomPadding??0);this.isBidirectional?(this._trackpad.yAxis.max=-Math.abs(e),this._trackpad.xAxis.max=-Math.abs(i)):this.isVertical?this._trackpad.yAxis.max=-Math.abs(e):this.isHorizontal&&(this._trackpad.xAxis.max=-Math.abs(i))}this._dimensionChanged?(this.list?.arrangeChildren(),this.stopRenderHiddenItems(),this._dimensionChanged=!1):(t&&this.list?.arrangeChildren(),this.updateVisibleItems()),this.lastScrollX=void 0,this.lastScrollY=void 0}}onMouseScroll(t){if(!this.isOver&&!this.options.globalScroll)return;this.renderAllItems();const i=!!this.options.shiftScroll,e=i?typeof t.deltaX<"u"||typeof t.deltaY<"u":typeof t.deltaX<"u",n=typeof t.deltaY<"u";if((this.isHorizontal||this.isBidirectional)&&e){const h=i||this.isBidirectional?t.deltaX:t.deltaY,r=(this.list?.x??0)-h;if(this.listWidth<this._width)this._trackpad&&(this._trackpad.xAxis.value=0);else{const o=this._width-this.listWidth,a=0;this._trackpad&&(this._trackpad.xAxis.value=Math.min(a,Math.max(o,r)))}}if((this.isVertical||this.isBidirectional)&&n){const h=(this.list?.y??0)-t.deltaY;if(this.listHeight<this._height)this._trackpad&&(this._trackpad.yAxis.value=0);else{const r=this._height-this.listHeight,o=0;this._trackpad&&(this._trackpad.yAxis.value=Math.min(o,Math.max(r,h)))}}this.isBidirectional&&(e||n)?this.onScroll?.emit({x:this._trackpad?.xAxis.value??0,y:this._trackpad?.yAxis.value??0}):this.isHorizontal&&e?this.onScroll?.emit(this._trackpad?.xAxis.value??0):this.isVertical&&n&&this.onScroll?.emit(this._trackpad?.yAxis.value??0),this.stopRenderHiddenItems()}scrollBottom(){this.interactive?this.scrollTo((this.list?.children.length??1)-1):this.scrollTop()}scrollTop(){this.renderAllItems(),this._trackpad&&(this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0),this.stopRenderHiddenItems()}renderAllItems(){clearTimeout(this.stopRenderHiddenItemsTimeout),this.stopRenderHiddenItemsTimeout=void 0,!this.options.disableDynamicRendering&&this.items.forEach(t=>{t.renderable=!0})}stopRenderHiddenItems(){this.options.disableDynamicRendering||(this.stopRenderHiddenItemsTimeout&&(clearTimeout(this.stopRenderHiddenItemsTimeout),this.stopRenderHiddenItemsTimeout=void 0),this.stopRenderHiddenItemsTimeout=setTimeout(()=>this.updateVisibleItems(),2e3))}updateVisibleItems(){this.visibleItems.length=0,this.items.forEach(t=>{t.renderable=this.isItemVisible(t),this.visibleItems.push(t)})}scrollTo(t){if(!this.interactive||!this._trackpad||!this.list)return;const i=this.list.children[t];i&&(this.renderAllItems(),this._trackpad.xAxis.value=this.isHorizontal||this.isBidirectional?this._width-i.x-i.width-this.list.rightPadding:0,this._trackpad.yAxis.value=this.isVertical||this.isBidirectional?this._height-i.y-i.height-this.list.bottomPadding:0,this.stopRenderHiddenItems())}scrollToPosition({x:t,y:i}){t===void 0&&i===void 0||(this.renderAllItems(),t!==void 0&&(this.scrollX=-t),i!==void 0&&(this.scrollY=-i),this.stopRenderHiddenItems())}get height(){return this._height}set height(t){this._height=t,this._dimensionChanged=!0,this.resize(),this.scrollTop()}get width(){return this._width}set width(t){this._width=t,this._dimensionChanged=!0,this.resize(),this.scrollTop()}setSize(t,i){typeof t=="object"?(i=t.height??t.width,t=t.width):i=i??t,this._width=t,this._height=i,this._dimensionChanged=!0,this.resize(),this.scrollTop()}getSize(t){return t=t||{width:0,height:0},t.width=this._width,t.height=this._height,t}get scrollX(){return this._trackpad?.xAxis.value??0}set scrollX(t){this._trackpad&&(this._trackpad.xAxis.value=t)}get scrollY(){return this._trackpad?.yAxis.value??0}set scrollY(t){this._trackpad&&(this._trackpad.yAxis.value=t)}update(){!this.list||!this._trackpad||(this._trackpad.update(),(this.isHorizontal||this.isBidirectional)&&this.list.x!==this._trackpad.x&&(this.list.x=this._trackpad.x),(this.isVertical||this.isBidirectional)&&this.list.y!==this._trackpad.y&&(this.list.y=this._trackpad.y),!this.options.disableProximityCheck&&(this._trackpad.x!==this.lastScrollX||this._trackpad.y!==this.lastScrollY)&&(this.proximityCheckFrameCounter++,this.proximityCheckFrameCounter>=(this.options.proximityDebounce??10)&&(this.items.forEach((t,i)=>{const e=this.isItemVisible(t,this.proximityRange),n=this.proximityStatusCache[i];e!==n&&(this.proximityStatusCache[i]=e,this.onProximityChange.emit({item:t,index:i,inRange:e}))}),this.lastScrollX=this._trackpad.x,this.lastScrollY=this._trackpad.y,this.proximityCheckFrameCounter=0)))}destroy(t){this.ticker.remove(this.update,this),document.removeEventListener("wheel",this.onMouseScrollBinding,!0),this.background?.destroy(),this.list?.destroy(),super.destroy(t)}restoreItemsInteractivity(){this.interactiveStorage.forEach(t=>{t.item.eventMode=t.eventMode}),this.interactiveStorage.length=0}revertClick(t){t.eventMode!=="auto"&&(S.any?t.emit("pointerupoutside",{target:t}):t.emit("mouseupoutside",{target:t}),this.interactiveStorage.push({item:t,eventMode:t.eventMode??"auto"}),t.eventMode="auto"),t instanceof v&&t.children&&t.children.forEach(i=>this.revertClick(i))}get scrollHeight(){return this.list?.height??0}get scrollWidth(){return this.list?.width??0}get isVertical(){return(this.options.type??"vertical")==="vertical"}get isHorizontal(){return this.options.type==="horizontal"}get isBidirectional(){return this.options.type==="bidirectional"}}var ai=Object.defineProperty,li=(s,t,i)=>t in s?ai(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,y=(s,t,i)=>li(s,typeof t!="symbol"?t+"":t,i);const di=5;class ci extends v{constructor(t){super(),y(this,"view",new v),y(this,"openButton"),y(this,"closeButton"),y(this,"openView"),y(this,"scrollBox"),y(this,"value",-1),y(this,"onSelect"),this.addChild(this.view),this.onSelect=new g.Signal,t&&this.init(t)}init({closedBG:t,textStyle:i,TextClass:e,items:n,openBG:h,selected:r,selectedTextOffset:o,scrollBox:a,visibleItems:d}){e=e??C,this.openView&&this.openView!==h&&this.view.removeChild(this.openView),this.openButton?(this.openButton.defaultView=z(t),this.openButton.textView=new e({text:n?.items?n.items[0]:"",style:i}),this.openButton.textOffset=o??{}):(this.openButton=new Z({defaultView:t,text:new e({text:n?.items?n.items[0]:"",style:i}),textOffset:o}),this.openButton.onPress.connect(()=>this.toggle()),this.addChild(this.openButton)),this.openView!==h&&(this.openView=z(h),this.view.visible=!1,this.view.addChild(this.openView)),this.closeButton?(this.closeButton.defaultView=new b().rect(0,0,this.openButton.width,this.openButton.height).fill({color:0,alpha:1e-5}),this.closeButton.textView=new e({text:n?.items?n.items[0]:"",style:i}),this.openButton.textOffset=o??{}):(this.closeButton=new Z({defaultView:new b().rect(0,0,this.openButton.width,this.openButton.height).fill({color:0,alpha:1e-5}),text:new e({text:n?.items?n.items[0]:"",style:i}),textOffset:o}),this.closeButton.onPress.connect(()=>this.toggle()),this.view.addChild(this.closeButton)),this.scrollBox?this.scrollBox.removeItems():(this.scrollBox=new oi,this.view.addChild(this.scrollBox)),this.scrollBox.init({type:"vertical",elementsMargin:0,width:this.openButton.width,height:this.openButton.height*(d??di),radius:0,padding:0,...a}),this.scrollBox.y=this.openButton.height,a?.offset&&(this.scrollBox.x=a.offset.x??0,this.scrollBox.y+=a.offset.y??0),this.addItems(n,r)}addItems(t,i=0){this.convertItemsToButtons(t).forEach((e,n)=>{const h=e.text;n===i&&(this.openButton.text=h??"",this.closeButton.text=h??""),e.onPress.connect(()=>{this.value=n,this.onSelect.emit(n,h??""),this.openButton.text=h??"",this.closeButton.text=h??"",this.close()}),this.scrollBox?.addItem(e)})}removeItem(t){this.scrollBox&&this.scrollBox.removeItem(t)}toggle(){this.view.visible=!this.view.visible,this.openButton.visible=!this.openButton.visible}open(){this.view.visible=!0,this.openButton.visible=!1}close(){this.view.visible=!1,this.openButton.visible=!0}convertItemsToButtons({items:t,backgroundColor:i,hoverColor:e,width:n,height:h,textStyle:r,TextClass:o,radius:a}){o=o??C;const d=[];return t.forEach(u=>{const V=new b().roundRect(0,0,n,h,a).fill(i),k=e??i,P=new b().roundRect(0,0,n,h,a).fill(k),Y=new o({text:u,style:r}),q=new Z({defaultView:V,hoverView:P,text:Y});d.push(q)}),d}}class ui extends v{constructor(t,i){super(),this.targetSize=i,this.item=t,this.sprite=new St(t,i,i),this.addChild(this.sprite);const e={fill:16777215,fontSize:20};this.nameText=new C(t.name,e),this.nameText.anchor.set(.5),this.nameText.position.set(48,110),this.descText=new C(t.description,e),this.descText.anchor.set(.5),this.descText.position.set(48,140),this.addChild(this.nameText),this.addChild(this.descText)}update(t){this.sprite.updateData?.(t),this.nameText.text=t.name,this.descText.text=t.description,this.item=t}showDetails(t=!0,i=!0){this.nameText.visible=t,this.descText.visible=i}}class xt extends Ct{constructor(t){super(t),this.score=0,this.maxTrials=10,this.draggingSprite=null,this.dragOffset={x:0,y:0},this.recipeCounter={ok:0,hitTotal:0,missTotal:0},this.drawUI(),this.drawTarget()}getCountString(){return`Hit: ${this.recipeCounter.hitTotal} Miss: ${this.recipeCounter.missTotal}`}drawUI(){this.scoreText=new C(this.getCountString(),{fill:16777215,fontSize:18}),this.scoreText.position.set(20,20),this.hudContainer.addChild(this.scoreText);const t={fill:0,fontSize:20},i=[{name:"Base Combo items",cb:()=>{this.ctx.currentSet=this.ctx.sets.base}},{name:"Emblem Combo items",cb:()=>{this.ctx.currentSet=this.ctx.sets.emblem}},{name:"All Combo items",cb:()=>{this.ctx.currentSet=this.ctx.sets.all}}],e=new ci({closedBG:new b().roundRect(0,0,200,40,10).fill(13421772),openBG:new b().roundRect(0,0,200,200,10).fill(15658734),textStyle:t,items:{items:i.map(n=>n.name),backgroundColor:15658734,hoverColor:14540253,width:200,height:40,textStyle:t},scrollBox:{width:200,height:160}});e.position.set(20,60),e.onSelect.connect((n,h)=>{const r=i.find(o=>o.name===h);r&&r.cb&&(r.cb(),this.ctx.goToScene(xt))}),this.hudContainer.addChild(e),this.ctx.app.ticker.add(()=>{e&&e.update&&e.update()})}drawTarget(){if(this.targetItem)this.targetItem.update(this.ctx.currentSet.getRandomCombinedItem());else{this.targetItem=new ui(this.ctx.currentSet.getRandomCombinedItem(),X);const t=this.gameAreaContainer.width,i=this.gameAreaContainer.height,e=X,n=X;this.targetItem.x=t/2-e/2,this.targetItem.y=i/2-n/2,this.gameAreaContainer.addChild(this.targetItem)}}findTargetTftItem(t){return t.id!==this.targetItem.item.id?null:this.targetItem.sprite}updateCounter(){this.scoreText.text=this.getCountString()}showTemporaryResult(t){const i=new G(j.from(`/items/${t.icon}`));i.width=80,i.height=80,i.position.set(this.ctx.app.screen.width/2-40,this.ctx.app.screen.height/2-40),i.alpha=.9,this.container.addChild(i);const e=new C(t.name,{fill:16777215,fontSize:20});e.anchor.set(.5),e.position.set(this.ctx.app.screen.width/2,this.ctx.app.screen.height/2+50),this.container.addChild(e),setTimeout(()=>{i.destroy(),e.destroy()},1e3)}onHit(t,i){this.recipeCounter.ok=0,this.recipeCounter.hitTotal++,this.updateCounter(),this.dragPanel.disableGlow(),this.drawTarget(),this.dragPanel.drawItems()}onMiss(t){this.recipeCounter.missTotal++,this.recipeCounter.missTotal%3===1&&this.dragPanel.glow(this.targetItem.item.recipe[0]),this.recipeCounter.missTotal%3===2&&this.dragPanel.glow(this.targetItem.item.recipe[1]),this.updateCounter()}destroy(){this.targetItem&&this.ctx.app.stage.off("pointermove",this.onDragMove,this),super.destroy()}}export{xt as default};
